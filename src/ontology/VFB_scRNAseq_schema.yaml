id: http://github.org/vfb/vfb-scRNAseq-ontology/VFB_scRNAseq
name: VFB_scRNAseq
imports:
  - linkml:types
prefixes:
  FBcv: http://purl.obolibrary.org/obo/FBcv_
  FBbt: http://purl.obolibrary.org/obo/FBbt_
  FBdv: http://purl.obolibrary.org/obo/FBdv_
  OBI: http://purl.obolibrary.org/obo/OBI_
  IAO: http://purl.obolibrary.org/obo/IAO_
  BAO: http://www.bioassayontology.org/bao#BAO_
  RO: http://purl.obolibrary.org/obo/RO_
  BFO: http://purl.obolibrary.org/obo/BFO_
  linkml: https://w3id.org/linkml/
  FlyBase: http://flybase.org/reports/
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  oboInOwl: http://www.geneontology.org/formats/oboInOwl#
  owl: http://www.w3.org/2002/07/owl#
  dcterms: http://purl.org/dc/terms/
  neo_custom: http://n2o.neo/custom/
  neo_property: http://n2o.neo/property/
  vfb: http://virtualflybrain.org/reports/
default_curi_maps:
    - semweb_context
default_range: string


classes:
  
  Thing:
    class_uri: owl:Class
    slots:
      - id

  Class:
    is_a: Thing
    slots:
      - name
      - title

  Dataset:
    is_a: Class
    class_uri: FBcv:0003023
    annotations:
      owl: NamedIndividual
      owl.fstring: ClassAssertion( FBcv:0003023 {id} )
    attributes:
      publication:
        slot_uri: dcterms:references
        description: Publication associated with the Dataset.
        range: Publication
        annotations:
          owl: AnnotationProperty
      licence:
        slot_uri: dcterms:licence
        description: Licence for the Dataset (all CC-BY 4.0 for scExpressionAtlas).
        range: Thing
        annotations:
          owl: AnnotationProperty
      assay_type:
        slot_uri: OBI:0000312
        description: Assay type (FBcv ID) for the Dataset, this will probably be 'FBcv:0009000' ('single-cell RNA-seq').
        range: Thing
        annotations:
          owl: ClassAssertion, ObjectSomeValuesFrom
      site:
        slot_uri: oboInOwl:hasDbXref
        description: VFB site node curie. The site must be created in VFB and added to the dictionary in ../scripts/process_site_data.py to successfully map from FB data.
        range: Thing
        annotations:
          owl: AnnotationProperty
          owl.axiom_annotation.slots:
            value: accession
      accession:
        slot_uri: neo_custom:accession
        description: Accession of the Dataset at the given Site.
        range: string
        multivalued: true
    slots:
      - neo_label

  Sample:
    is_a: Class
    class_uri: FBcv:0003024
    annotations:
      owl: NamedIndividual
      owl.fstring: ClassAssertion( FBcv:0003024 {id} )
    attributes:
      sample_tissue:
        slot_uri: RO:0002131
        description: Tissue(s) (FBbt IDs) in the sample. Multiple IDs should be separated with '|' or in different rows. Maps as an overlaps relationship rather than part_of due to imprecision of dissection.
        range: Thing
        annotations:
          owl: ClassAssertion, ObjectSomeValuesFrom
        multivalued: true
      associated_assay:
        slot_uri: RO:0002352
        description: Assay(s) that use this sample. Multiple IDs should be separated with '|' or in different rows.
        range: Assay
        annotations:
          owl: ObjectPropertyAssertion
        multivalued: true
    slots:
      - stage
      - associated_dataset
      - sex
      - neo_label

  Assay:
    is_a: Class
    class_uri: FBcv:0003025
    annotations:
      owl: NamedIndividual
      owl.fstring: ClassAssertion( FBcv:0003025 {id} )
    attributes:
      method:
        slot_uri: BAO:0000212
        description: Method used for the assay - currently getting any direct subclass of FBcv:0009005 'single-cell library sequencing'.
        range: Thing
        annotations:
          owl: ClassAssertion, ObjectSomeValuesFrom
        multivalued: false
      associated_sample_for_assay:
        slot_uri: RO:0002233
        description: Input sample(s) for the scRNAseq assay. Multiple IDs should be separated with '|' or in different rows.
        range: Sample
        annotations:
          owl: ObjectPropertyAssertion
        multivalued: true
    slots:
      - associated_dataset
      - neo_label

  Clustering:
    is_a: Class
    class_uri: FBcv:0009002
    annotations:
      owl: NamedIndividual
      owl.fstring: ClassAssertion( FBcv:0009002 {id} )
    attributes:
      associated_sample_for_clustering:
        slot_uri: BFO:0000051
        description: Sample (FBlc ID) that the Clustering uses.
        range: Sample
        annotations:
          owl: ObjectPropertyAssertion
    slots:
      - associated_dataset

  Cluster:
    is_a: Class
    class_uri: FBcv:0009003
    annotations:
      owl: NamedIndividual
      owl.fstring: ClassAssertion( FBcv:0009003 {id} )
    attributes:
      associated_clustering:
        slot_uri: BFO:0000050
        description: Clustering (FBlc ID) that the Cluster belongs to.
        range: Clustering
        annotations:
          owl: ObjectPropertyAssertion
      cell_number:
        slot_uri: BAO:0002811
        description: The number of cells in the Cluster (as integer).
        range: integer
        annotations:
          owl.fstring: DataPropertyAssertion( BAO:0002811 {id} {cell_number} ^^xsd:integer )
      cell_type:
        slot_uri: RO:0002473
        description: Anatomy (FBbt IDs) for the Cluster. Multiple IDs should be separated with '|'.
        range: Thing
        multivalued: true
        annotations:
          owl: ClassAssertion, ObjectSomeValuesFrom
      hide_in_terminfo:
        slot_uri: neo_custom:hide_in_terminfo
        description: Flag to hide expression edges in VFB Term Info pane. Range must be string - boolean changes capitalisation and does not add datatype anyway.
      expression_extent:
        slot_uri: neo_custom:expression_extent
        description: Extent of expression of the given gene.
        range: float
      expression_level:
        slot_uri: neo_custom:expression_level
        description: Level of expression of the given gene.
        range: float
      gene:
        slot_uri: RO:0002292
        description: A gene (FBgn ID) expressed by the Cluster. Max one gene per tsv row alongside its expression_extent and expression_level.
        range: Thing
        annotations:
          owl: ClassAssertion, ObjectSomeValuesFrom
          owl.fstring: ClassAssertion ( Annotation ( neo_custom:hide_in_terminfo {hide_in_terminfo} ) Annotation ( neo_custom:expression_level {expression_level} ) Annotation ( neo_custom:expression_extent {expression_extent} ) ObjectSomeValuesFrom ( RO:0002292 {V}) {id})
    slots:
      - stage
      - associated_dataset
      - sex
      - neo_label

  Publication:
    is_a: Thing
    class_uri: FBcv:0000212
    annotations:
      owl: NamedIndividual
    slots:
      - neo_label

# slots can be used as attributes that can be shared by multiple classes
slots:
  id:
    description: Identifier for the entity. FlyBase identifiers should be prefixed with 'FlyBase:'.
    identifier: true
    range: uriorcurie
    required: true
  name:
    slot_uri: rdfs:label
    description: Short systematic label for the entity.
    annotations:
      owl: AnnotationAssertion
    recommended: true
  title:
    slot_uri: IAO:0000115
    description: Short description of the entity.
    annotations:
      owl: AnnotationAssertion
    recommended: true
  associated_dataset:
    slot_uri: dcterms:source
    description: Dataset (FBlc ID) that the Sample or Cluster belongs to.
    range: Dataset
    annotations:
      owl: AnnotationProperty
  sex:
    slot_uri: BFO:0000050
    description: Sex for the entity. Should be 'male' or 'female'.
    range: sex_options
    annotations:
      owl: ClassAssertion, ObjectSomeValuesFrom
  stage:
    slot_uri: RO:0002490
    description: Developmental stage (FBdv ID) of the Sample or Cluster.
    range: Thing
    annotations:
      owl: ClassAssertion, ObjectSomeValuesFrom
  neo_label:
    slot_uri: neo_property:nodeLabel
    description: neo4j node label to add to entity.
    annotations:
      owl: AnnotationProperty

enums:
  sex_options:
    permissible_values:
      male:
        meaning: FBbt:00007004
      female:
        meaning: FBbt:00007011
